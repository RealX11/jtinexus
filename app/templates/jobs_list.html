{% extends "base.html" %}
{% block content %}
<table id="jobs" class="display nowrap" style="width:100%">
  <thead>
    <tr>
      {% for col in columns %}
      <th>{{ col }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for row in rows %}
    <tr>
      {% for col in columns %}
      <td>{{ row[col] }}</td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
$(document).ready(function () {
  // DataTables ba≈ülat
  const table = $('#jobs').DataTable({
    scrollX: true,
    dom: 'Bfrtip',
    buttons: [
      {
        extend: 'colvis',
        text: 'üß© Kolon Se√ß / Gizle',
        className: 'btn btn-light'
      },
      {
        extend: 'pageLength',
        text: 'Sayfa Boyutu'
      }
    ],
    pageLength: 25,
    language: {
      url: "https://cdn.datatables.net/plug-ins/1.13.4/i18n/tr.json"
    }
  });

  // Kolon g√∂r√ºn√ºrl√ºklerini localStorage'a kaydet
  table.on('column-visibility.dt', function () {
    const visible = [];
    table.columns().every(function (i) {
      visible.push(this.visible());
    });
    localStorage.setItem('visibleColumns', JSON.stringify(visible));
  });

  // Kaydedilmi≈ü kolon g√∂r√ºn√ºrl√ºklerini geri y√ºkle
  const saved = localStorage.getItem('visibleColumns');
  if (saved) {
    const visible = JSON.parse(saved);
    table.columns().every(function (i) {
      this.visible(visible[i] ?? true);
    });
  }
});
</script>
{% endblock %}
